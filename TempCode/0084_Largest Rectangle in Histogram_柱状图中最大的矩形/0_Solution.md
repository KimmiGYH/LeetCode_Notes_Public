# 84_Largest Rectangle in Histogram_柱状图中最大的矩形

[Youtube_basketwang_视频了解题意](https://youtu.be/KkJrGxuQtYo)

## 解法一：朴素单调栈 $O(n)$

- 可以观察到对于每个柱子而言它能构成的最大矩形的宽度由左右两边第一个比它小的柱子的位置而决定。**而求某一个点左右两边第一个比它大/小的元素是单调栈的经典应用**。

- 朴素的做法是头尾分别扫描两次，用一个 **严格** 单调递增的栈`求出每个柱子左右两边第一个严格小于它的柱子的位置`，对于数组的两边我们可以想象成各有一个无限小的柱子。

- 之后再遍历一遍数组求出答案。

## 解法二：单调栈 $O(n)$

- 我们不用找到每个柱子左右两边第一个严格小于它的柱子，我们用一个 **非严格单调递增的栈**。

- 此题的本质是找到每个柱形条左边和右边最近的比自己低的矩形条，然后用宽度乘上当前柱形条的高度作为备选答案。

- 解决此类问题的经典做法是单调栈，维护一个单调递增的栈，如果当前柱形条 `i` 的高度比栈顶要低，则栈顶元素 `cur` 出栈。出栈后，`cur` 右边第一个比它低的柱形条就是 `i`，左边第一个比它低的柱形条是当前栈中的 `top`。不断出栈直到栈为`空`或者柱形条 `i` 不再比 `top` 低。

**V2版本：**

![solve2](https://img-blog.csdnimg.cn/20200530112008666.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIxMjAxMjY3,size_16,color_FFFFFF,t_70)

重申两点：

- 单调递增栈，遇到递减的进行处理，最后未处理完的，在末尾加个 `0`（遇到递减了，处理剩余的）

- 栈内左侧的都比栈顶小，当前的也比其小，那么以**栈顶为高**的矩形能够扩展的宽度就知道了，`宽度 = 当前位置 减去 栈顶左侧位置，再减1`

**时间复杂度：**

- 每个元素最多进栈一次，出栈一次，故时间复杂度为 $O(n)$。

**空间复杂度：**

- 需要额外 $O(n)$ 的空间存储栈。
