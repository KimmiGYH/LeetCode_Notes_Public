# 438. Find All Anagrams in a String_找到字符串中所有字母异位词

花花酱：[https://youtu.be/86fQQ7rVGxA](https://youtu.be/86fQQ7rVGxA)

## 解法一：数组映射 $O(C*n + m)$

- 先创建一个大小为 $26$ 的数组 $vp$ 来统计字符串 $p$ 的词频
- 另外一个同等大小的数组 $vs$ 用来统计「滑动窗口」内的 $s$ 的子串词频
- 当两个数组所统计词频相等，说明找到了一个异位组，将窗口的左端点加入答案。

**复杂度分析**
- **时间复杂度**：整体复杂度为 $O(C*n + m)$。
  - 令 `s` 和 `p` 的长度分别为 $n$ 和 $m$，$C = 26$ 为字符集大小。
  - 统计 `p` 词频（构建 `vp` 数组）的复杂度为 $O(m)$；
  - 使用双指针检查 `s` 串的复杂度为 $O(C * n)$。
- **空间复杂度**：$O(C)$

## 解法二：共用哈希表

- 解法一中每次对滑动窗口的检查都不可避免需要检查两个词频数组，复杂度为 $O(C)$。
- 事实上，我们只关心两个数组是否完全一致，因而我们能够只维护一个词频哈希表 $hash$ 来实现。
- 起始处理 `p` 串时，只对 $hash$ 进行词频字符自增操作。当处理 `s` 的滑动窗口子串时，尝试对 $hash$ 中的词频进行「抵消/恢复」操作：
  - 当滑动窗口的右端点右移时（增加字符），对 $hash$ 执行右端点字符的「抵消」操作；
  - 当滑动窗口的左端点右移时（减少字符），对 $hash$ 执行左端点字符的「恢复」操作。

- 使用变量 `tot` 记录 $hash$ 中有多少种字符，使用变量 `satisfy` 统计滑动窗口（子串）内有多少种字符词频与 `p` 中的相等。

- 当区间长度 `j - i + 1` 大于目标串长度时，要删最左端的字符
  - 如果删之前 $s[i]$ 这个字符已被抵消为 $0$ 了，删完就被恢复了一次，所以 `satisfy--`，匹配字符数减 $1$
  - 删之前是被抵消为 $0$ 了，由于共用一个哈希表，所以 `hash[s[i++]]++` 删完之后 表示该字母已被恢复一次，还需要匹配一次来抵消。

- 当且仅当 $tot == satisfy$ 时，我们找到了一个新的异位组，记录下标 `i`。

**复杂度分析**
- **时间复杂度**：令 `s` 和 `p` 的长度分别为 $n$ 和 $m$，$C = 26$ 为字符集大小。构造 $hash$ 的复杂度为 $O(m)$，统计 `p` 中不同的字符数量为 $O(C)$，对 `s` 进行滑动窗口扫描得出答案的复杂度为 $O(n)$。整体复杂度为 $O(m + C + n)$。
- **空间复杂度**：$O(C)$

## 写法三：分开哈希表

- 开两个哈希表，一个是子串的 $hashP$，另一个是原串的 $hashS$
- $check$ 函数判断字符是否在子串的哈希表中出现过，且两个哈希表中该字符词频一样
  ```cpp
  bool check(char c) {
      if (hashP.count(c) && hashP[c] == hashS[c]) //判断字符是否在字串哈希表中出现且数量一样
          return true;
      return false;
  ```
- 添加 $s$ 串右端点的字符前，先判断 $check$ 函数是否返回 $true$，如果 $check$ 满足，那么添加 $s$ 右端点字符后，匹配字符数减少了 `satisfy--`
- 添加完字符后，检查 $check$ 是否满足，如果满足，说明匹配字符数增加了 `satisfy++`
- 同理，删掉 $s$ 串左端点的字符前，也检查 $check$ 函数是否满足，如果满足，那么即将删掉字符后，匹配字符数减少了 `satisfy--`
- 删完字符后，检查 $check$ 是否满足，如果满足，说明匹配字符数增加了 `satisfy++`
- 当且仅当 $tot == satisfy$ 时，返回 $true$
